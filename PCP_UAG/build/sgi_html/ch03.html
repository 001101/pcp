<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type"><title>Chapter 3. Common Conventions and Arguments</title><meta name="generator" content="DocBook XSL Stylesheets V1.51.1"><meta name="generator" content="SGI XSL DocBook Customization Stylesheets V1.1"><link rel="home" href="index.html" title="Performance Co-Pilot&#8482; for IA-64 Linux User's and Administrator's
Guide"><link rel="up" href="index.html" title="Performance Co-Pilot&#8482; for IA-64 Linux User's and Administrator's
Guide"><link rel="previous" href="ch02.html" title="Chapter 2. Installing and Configuring Performance Co-Pilot
"><link rel="next" href="ch04.html" title="Chapter 4. Monitoring System Performance"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 3. Common Conventions and Arguments</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch04.html">Next</a></td></tr></table><hr></div><!--CONTENT_BEGIN--><a name="sgi_start_content"></a><div class="chapter"><div class="titlepage"><div><h2 class="title"><a name="LE94335-PARENT"></a>Chapter 3. Common Conventions and Arguments</h2></div></div>
<p><a class="indexterm" name="ITch03-0"></a> <a class="indexterm" name="ITch03-1"></a><a class="indexterm" name="Z1033415461tls"></a> This chapter deals with the user interface
components that are common to most text-based utilities that make up the
monitor portion of Performance Co-Pilot (PCP). These are the major sections
in this chapter:</p>
<div class="itemizedlist"><ul type="disc"><li><p><a href="ch03.html#LE85600-PARENT" title="3.1. Alternate Metrics Source Options">Section 3.1</a>, details some basic standards
used in the development of PCP tools.</p>
</li>
<li><p><a href="ch03.html#LE68596-PARENT" title="3.2. General PCP Tool Options">Section 3.2</a>, details other options
to use with PCP tools.</p>
</li>
<li><p><a href="ch03.html#LE76997-PARENT" title="3.3. Time Duration and Control">Section 3.3</a>, describes the time control
dialog and time-related command line options available for use with PCP
tools.</p>
</li>
<li><p><a href="ch03.html#LE61303-PARENT" title="3.4. PCP Environment Variables">Section 3.4</a>, describes the environment
variables supported by PCP tools.</p>
</li>
<li><p><a href="ch03.html#LE12082-PARENT" title="3.5. Running PCP Tools through a Firewall">Section 3.5</a>, describes how to execute
PCP tools that must retrieve performance data from the Performance Metrics
Collection Daemon (PMCD) on the other side of a TCP/IP security firewall.
</p>
</li>
<li><p><a href="ch03.html#LE17322-PARENT" title="3.6. Transient Problems with Performance Metric Values
">Section 3.6</a>, covers some uncommon
scenarios that may compromise performance metric integrity over the short
term.</p>
</li>
</ul></div><p><a class="indexterm" name="ITch03-2"></a>Many of the utilities provided with
PCP conform to a common set of naming and syntactic conventions for command
line arguments and options. This section outlines these conventions and
their meaning. The options may be generally assumed to be honored for
all utilities supporting the corresponding functionality.</p>
<p>In all cases, the man pages for each utility fully describe the
supported command arguments and options.</p>
<p><a class="indexterm" name="IG31371888114"></a>Command line
options are also relevant when starting PCP applications from the desktop
using the <tt>Alt</tt> double-click method. This technique launches
the <tt>pmrun</tt> program to collect additional arguments to
pass along when starting a PCP application.</p>
<div class="section"><div class="titlepage"><div><h2 class="title"><a name="LE85600-PARENT"></a>3.1. Alternate Metrics Source Options</h2></div></div>
<p>The default source of performance metrics is from PMCD on the local
host. This section describes how to obtain metrics from sources other
than the default.</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5193612"></a>3.1.1. Fetching Metrics from Another Host</h3></div></div>
<p><a class="indexterm" name="ITch03-3"></a><a class="indexterm" name="IG31371888115"></a><a class="indexterm" name="IG31371888116"></a>The option <tt>-h </tt><i>
host</i> directs any PCP utility (such as <tt>pmchart</tt>
or <tt>dkvis</tt>) to make a connection with the PMCD instance
running on <i>host</i>. Once established, this connection
serves as the principal real-time source of performance metrics and metadata.
</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5193712"></a>3.1.2. Fetching Metrics from an Archive Log</h3></div></div>
<p><a class="indexterm" name="ITch03-6"></a><a class="indexterm" name="ITch03-5"></a><a class="indexterm" name="ITch03-8"></a>The option <tt>-a </tt><i>archive</i> directs the utility to
treat the PCP archive logs with base name <i>archive</i>
as the principal source of performance metrics and metadata.</p>
<p><a class="indexterm" name="IG31371888117"></a>PCP archive logs are created with <tt>pmlogger
</tt>. Most PCP utilities operate with equal facility for performance
information coming from either a real-time feed via PMCD on some host,
or for historical data from a PCP archive log. For more information on
archive logs and their use, see <a href="ch06.html" title="Chapter 6. Archive Logging">Chapter 6, &#8220;Archive Logging&#8221;</a>.</p>
<p><a class="indexterm" name="ITch03-9"></a>The base name (<tt>archive
</tt>) of the PCP archive log used with the <tt>-a</tt>
option implies the existence of the files created automatically by <tt>
pmlogger</tt>, as listed in <a href="ch03.html#id5193871" title="Table 3-1. Physical Filenames for Components of a PCP
Archive Log">Table 3-1</a>.</p>
<div class="table"><a name="id5193871"></a><p><a name="id5193871"></a><b>Table 3-1. Physical Filenames for Components of a PCP
Archive Log</b></p>
<table summary="Physical Filenames for Components of a PCP
Archive Log" border="1"><colgroup><col><col></colgroup><thead><tr valign="top"><th scope="col" align="left" valign="bottom"><p>Filename</p>
</th><th scope="col" align="left" valign="bottom"><p>Contents</p>
</th></tr></thead><tbody><tr valign="top"><td scope="row" align="left" valign="top"><p><tt>archive.</tt><i>
index</i><span class="bold"><b></b></span></p>
</td><td align="left" valign="top"><p>Temporal index for rapid access
to archive contents</p>
</td></tr><tr valign="top"><td scope="row" align="left" valign="top"><p><tt>archive.</tt><i>
meta</i></p>
</td><td align="left" valign="top"><p>Metadata descriptions for performance
metrics and instance domains appearing in the archive</p>
</td></tr><tr valign="top"><td scope="row" align="left" valign="top"><p><tt>archive.N</tt></p>
</td><td align="left" valign="top"><p>Volumes of performance metrics
values, for <tt>N</tt> = 0,1,2,...</p>
</td></tr></tbody></table></div><p>Some tools are able to concurrently process multiple PCP archive
logs (for example, for retrospective analysis of performance across multiple
hosts), and accept either multiple <tt>-a</tt> options or a
comma separated list of archive names following the <tt>-a</tt>
option.</p>
<div class="note"><hr noshade="noshade"><table border="0"><tr><td align="center" valign="top" width="25"><img src="figures/note.png" height="24" width="24"></td><td align="left" valign="top"><b>Note: </b>The <tt>-h</tt> and <tt>-a</tt> options
are mutually exclusive in all cases.
</td></tr></table><hr noshade="noshade"></div><br></div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="LE68596-PARENT"></a>3.2. General PCP Tool Options</h2></div></div>
<p><a class="indexterm" name="IG31371888118"></a>The following
sections provide information relevant to most of the PCP tools. It is
presented here in a single place for convenience.</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5194103"></a>3.2.1. Common Directories and File Locations</h3></div></div>
<p><a class="indexterm" name="IG31371888119"></a><a class="indexterm" name="IG31371888120"></a>The following files and directories
are used by the PCP tools as repositories for option and configuration
files and for binaries:</p>
<div class="variablelist"><table border="0" cellspacing="3"><tr valign="top"><td width="45%"><span class="term"><tt>/etc/pcp.env</tt></span></td><td width="55%"><p><a class="indexterm" name="IG31371888121"></a>Script
to set PCP run-time environment variables.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/etc/pcp.conf</tt></span></td><td width="55%"><p><a class="indexterm" name="IG31371888122"></a>PCP
configuration and environment file.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/var/pcp/config/pmcd/pmcd.conf</tt></span></td><td width="55%"><p><a class="indexterm" name="IG31371888123"></a><a class="indexterm" name="IG31371888124"></a>Configuration file for Performance Metrics
Collection Daemon (PMCD). Sets environment variables, including <tt>PATH</tt>.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/usr/share/pcp/bin/pmcd</tt></span></td><td width="55%"><p><a class="indexterm" name="IG31371888125"></a>The PMCD binary.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/var/pcp/config/pmcd.options</tt></span></td><td width="55%"><p><a class="indexterm" name="IG31371888126"></a>Command line options for PMCD.<br>
</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/etc/rc.d/init.d/pcp</tt></span></td><td width="55%"><p><a class="indexterm" name="IG31371888127"></a>The PMCD startup script.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/usr/share/pcp/bin/<i>pcptool</i></tt></span></td><td width="55%"><p>Directory containing PCP tools such as <tt>pmkstat
</tt>, <tt>pminfo</tt>, <tt>pmlogger</tt>, <tt>
pmnewlog</tt>, <tt>pmnsmerge</tt>, <tt>pmpost</tt>,
and so on.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/usr/share/pcp</tt></span></td><td width="55%"><p>Directory containing shareable PCP-specific files and
repository directories such as <tt>bin</tt>,  <tt>demos
</tt>,  <tt>examples</tt> and  <tt>lib</tt>.
</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/var/pcp</tt></span></td><td width="55%"><p>Directory containing non-shareable (that is, per-host)
PCP specific files and repository directories. There are some symbolic
links from the <tt>/usr/share/pcp</tt> directory hierarchy
pointing into the <tt>/var/pcp</tt> directory hierarchy.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/usr/share/pcp/bin/<i>pcptool</i></tt></span></td><td width="55%"><p>PCP tools that are typically not executed directly by
the end user such as <tt>pmbrand</tt>, <tt>pmnscomp</tt>,
and <tt>pmlogger</tt>.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/usr/share/pcp/lib/<i>pcplib</i></tt></span></td><td width="55%"><p>Miscellaneous PCP libraries and executables.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/var/pcp/pmdas</tt></span></td><td width="55%"><p> Performance Metric Domain Agents (PMDAs), one directory
per PMDA.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/var/pcp/config</tt></span></td><td width="55%"><p>Configuration files for PCP tools, typically with one
directory per tool.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/usr/share/pcp/demos</tt></span></td><td width="55%"><p>Demonstration data files and example programs.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/var/log/pcp</tt></span></td><td width="55%"><p>By default, diagnostic and trace log files generated by
PMCD and PMDAs. Also, the PCP archive logs are managed in one directory
per logged host below here.</p>

</td></tr><tr valign="top"><td width="45%"><span class="term"><tt>/var/pcp/pmns</tt></span></td><td width="55%"><p>Files and scripts for the Performance Metrics Name Space
(PMNS).</p>

</td></tr></table></div></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5194616"></a>3.2.2. Alternate Performance Metric Name Spaces</h3></div></div>
<p><a class="indexterm" name="ITch03-10"></a>The Performance Metrics Name Space (PMNS) defines
a mapping from a collection of external names for performance metrics
(convenient to the user) into corresponding internal identifiers (convenient
for the underlying implementation).</p>
<p>The distributed PMNS used in PCP 2.x avoids most requirements for
an alternate PMNS, because clients' PMNS operations are supported at the
Performance Metrics Collection Daemon (PMCD) or by means of PMNS data
in a PCP archive log. The distributed PMNS is the default, but alternates
may be specified using the <tt>-n </tt><i>namespace
</i> argument to the PCP tools. When a PMNS is maintained on
a host, it is likely to reside in the <tt>/var/pcp/pmns</tt>
directory.</p>
<p><a class="indexterm" name="IG31371888128"></a>Refer to the <tt>pmns(4)</tt> and <tt>pmnscomp(1)</tt> man pages for details of PMNS structure
and creation.</p>
</div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="LE76997-PARENT"></a>3.3. Time Duration and Control</h2></div></div>
<p><a class="indexterm" name="IG31371888129"></a>The periodic
nature of sampling performance metrics and refreshing the displays of
the PCP tools makes specification and control of the temporal domain a
common operation. In the following sections, the services and conventions
for specifying time positions and intervals are described.</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="LE96583-PARENT"></a>3.3.1. Performance Monitor Reporting Frequency and
Duration</h3></div></div>
<p><a class="indexterm" name="IG31371888130"></a><a class="indexterm" name="IG31371888131"></a>Many of the performance monitoring
utilities have periodic reporting patterns. The <tt>-t </tt> <i>
interval</i> and <tt>-s </tt><i>samples
</i> options are used to control the sampling (reporting) interval,
usually expressed as a real number of seconds (<i>interval</i>),
and the number of <i>samples</i> to be reported, respectively.
In the absence of the <tt>-s</tt> flag, the default behavior
is for the performance monitoring utilities to run until they are explicitly
stopped.</p>
<p><a class="indexterm" name="IG31371888132"></a>The <i>
interval</i> argument may also be expressed in terms of minutes,
hours, or days, as described in the <tt>PCPIntro(1)</tt>
man page.</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="LE14729-PARENT"></a>3.3.2. Time Window Options</h3></div></div>
<p><a class="indexterm" name="IG31371888133"></a><a class="indexterm" name="IG31371888134"></a>The following options may
be used with most PCP tools (typically when the source of the performance
metrics is a PCP archive log) to tailor the beginning and end points of
a display, the sample origin, and the sample time alignment to your convenience.
</p>
<p>The <tt>-S</tt>, <tt>-T</tt>, <tt>-O</tt>
and <tt>-A</tt> command line options are used by PCP applications
to define a time window of interest.</p>
<div class="variablelist"><table border="0" cellspacing="3"><tr valign="top"><td width="25%"><span class="term"><tt>-S </tt> <i>duration</i></span></td><td width="75%"><p>The start option may be used to request that the display
start at the nominated time. By default, the first sample of performance
data is retrieved immediately in real-time mode, or coincides with the
first sample of data in a PCP archive log in archive mode. For archive
mode, the <tt>-S</tt> option may be used to specify a later
time for the start of sampling. By default, if <i>duration</i>
is an integer, the units are assumed to be seconds.</p>
<p>To specify an offset from the beginning of a PCP archive (in archive
mode) simply specify the offset as the <i>duration</i>.
For example, the following entry retrieves the first sample of data at
exactly 30 minutes from the beginning of a PCP archive.</p>
<p><table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">-S 30min </pre></td></tr></table><br></p>
<p>To specify an offset from the end of a PCP archive, prefix the <i>
duration</i> with a minus sign. In this case, the first sample
time precedes the end of archived data by the given <i>duration
</i>. For example, the following entry retrieves the first sample
exactly one hour preceding the last sample in a PCP archive.</p>
<p><table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">-S -1hour </pre></td></tr></table><br></p>
<p>To specify the calendar date and time (local time in the reporting
timezone) for the first sample, use the <tt>ctime</tt> syntax
preceded by an &#8220;at&#8221; sign (@). For example, the following entry
specifies the date and time to be used.</p>
<p><table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">-S '@ Mon Mar 4 13:07:47 1996' </pre></td></tr></table><br></p>
<p>Note that this format corresponds to the output format of the <tt>
date</tt> command for easy &#8220;cut and paste.&#8221; However,
be sure to enclose the string in quotes so it is preserved as a single
argument for the PCP tool.</p>
<p>For more complete information on the date and time syntax, see the <tt>PCPIntro(1)</tt> man page.</p>

</td></tr><tr valign="top"><td width="25%"><span class="term"><tt>-T </tt> <i>duration</i> </span></td><td width="75%"><p>The terminate option may be used to request that the display
stop at the time designated by <i>duration</i>. By
default, the PCP tools keep sampling performance data indefinitely (in
real-time mode) or until the end of a PCP archive (in archive mode). The <tt>-T</tt> option may be used to specify an earlier time to terminate
sampling.</p>
<p>The interpretation for the <i>duration</i> argument
in a <tt>-T</tt> option is the same as for the <tt>-S</tt>
option, except for an unsigned time interval that is interpreted as being
an offset from the start of the time window as defined by the default
(now for real time, else start of archive) or by a <tt>-S</tt>
option. For example, these options define a time window that spans 45
minutes, after an initial offset (or delay) of 1 hour:<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">-S 1hour -T 45mins</pre></td></tr></table><br></p>

</td></tr><tr valign="top"><td width="25%"><span class="term"><tt>-O </tt> <i>duration</i></span></td><td width="75%"><p>By default, samples are fetched from the start time (see
the description of the <tt>-S</tt> option) to the terminate
time (see the description of the <tt>-T</tt> option). The offset <tt>-O</tt> option allows the specification of a time between the start
time and the terminate time where the tool should position its initial
sample time. This option is useful when initial attention is focused at
some point within a larger time window of interest, or when one PCP tool
wishes to launch another PCP tool with a common current point of time
within a shared time window.</p>
<p>The <i>duration</i> argument accepted by <tt>-O</tt> conforms to the same syntax and semantics as the <i>
duration</i> argument for <tt>-T</tt>. For example,
these options specify that the initial position should be the end of the
time window:<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">-O -0 </pre></td></tr></table><br></p>
<p>This is most useful with the <tt>pmchart</tt> command
to display the tail-end of the history up to the end of the time window.
</p>

</td></tr><tr valign="top"><td width="25%"><span class="term"><tt>-A </tt> <i>alignment</i></span></td><td width="75%"><p>By default, performance data samples do not necessarily
happen at any natural unit of measured time. The <tt>-A</tt>
switch may be used to force the initial sample to be on the specified <i>
alignment</i>. For example, these three options specify alignment
on seconds, half hours, and whole hours:<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">-A 1sec 
-A 30min 
-A 1hour</pre></td></tr></table><br></p>
<p>The <tt>-A</tt> option advances the time to achieve the
desired alignment as soon as possible after the start of the time window,
whether this is the default window, or one specified with some combination
of <tt>-A</tt> and <tt>-O</tt> command line options.
</p>

</td></tr></table></div><p>Obviously the time window may be overspecified by using multiple
options from the set <tt>-t</tt>, <tt>-s</tt>, <tt>-S</tt>, <tt>-T</tt>, <tt>-A</tt>, and <tt>-O</tt>. Similarly, the time window may shrink to nothing by injudicious
choice of options.</p>
<p>In all cases, the parsing of these options applies heuristics guided
by the principal of &#8220;least surprise&#8221;; the time window is always
well-defined (with the end never earlier than the start), but may shrink
to nothing in the extreme.</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5195323"></a>3.3.3. Timezone Options</h3></div></div>
<p><a class="indexterm" name="ITch03-12"></a>All
utilities that report time of day use the local timezone by default. The
following timezone options are available:</p>
<div class="variablelist"><table border="0" cellspacing="3"><tr valign="top"><td><span class="term"><tt>-z</tt></span></td><td width="10"> </td><td><p>Forces times to be reported in the timezone of the host
that provided the metric values (the PCP collector host). When used in
conjunction with <tt>-a</tt> and multiple archives, the convention
is to use the timezone from the first named archive.</p>

</td></tr><tr valign="top"><td><span class="term"><tt>-Z </tt> <i>timezone</i> </span></td><td width="10"> </td><td><p><a class="indexterm" name="IG31371888135"></a>Sets
the TZ variable to a timezone string, as defined in <tt>
environ(5)</tt> , for example, <tt>-Z UTC</tt> for universal
time.</p>

</td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="LE61303-PARENT"></a>3.4. PCP Environment Variables</h2></div></div>
<p><a class="indexterm" name="ITch03-14"></a><a class="indexterm" name="IG31371888136"></a><a class="indexterm" name="IG31371888137"></a><a class="indexterm" name="IG31371888138"></a><a class="indexterm" name="IG31371888139"></a>When you are using
PCP tools and utilities and are calling PCP library functions, a standard
set of defined environment variables are available in the <tt>/etc/pcp.conf</tt>
file.  These variables are generally used to specify the location of various
PCP pieces in the file system and may be loaded into shell scripts by
sourcing the <tt>/etc/pcp.env</tt> shell script. They may
also be queried by C and C++ programs using the <tt>__pmGetConfig
</tt> library function.  If a variable is already defined in the
environment, the values in the <tt>pcp.conf</tt> file do not
override those values; that is,  the values in <tt>pcp.conf</tt>
serve only as installation defaults. For additional information, see the <tt>/etc/pcp.conf(4)</tt>, <tt>/etc/pcp.env(4)</tt>, and <tt>__pmGetConfig</tt>
man pages.</p>
<p>The following environment variables are recognized by PCP (these
definitions are also available on the <tt>PCPIntro
(1)</tt> man page):</p>
<div class="variablelist"><table border="0" cellspacing="3"><tr valign="top"><td colspan="2"><span class="term"><tt>PCP_COUNTER_WRAP</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-15"></a>Many of the performance metrics exported from PCP
agents expect that counters increase monotonically. Under some circumstances,
one value of a metric may be smaller than the previously fetched value.
This can happen when a counter of finite precision overflows, when the
PCP agent has been reset or restarted, or when the PCP agent exports values
from an underlying instrumentation that is subject to asynchronous discontinuity.
</p>
<p>If set, the <tt>PCP_COUNTER_WRAP</tt> environment variable
indicates that all such cases of a decreasing counter should be treated
as a counter overflow; and hence the values are assumed to have wrapped
once in the interval between consecutive samples. Counter wrapping was
the default in versions before the PCP release 1.3.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PCP_STDERR</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-18"></a><a class="indexterm" name="IG31371888140"></a><a class="indexterm" name="IG31371888141"></a>Specifies whether <tt>pmprintf()</tt> error messages
are sent to standard error, an <tt>xconfirm</tt> dialog box,
or to a named file; see the <tt>pmprintf(3)</tt>
man page. Messages go to standard error if <tt>PCP_STDERR</tt>
is unset or set without a value. If this variable is set to <tt>DISPLAY</tt>, then messages go to an <tt>xconfirm</tt>
dialog box; see the <tt>xconfirm(1)</tt> man page.
Otherwise, the value of <tt>PCP_STDERR</tt> is assumed to be
the name of an output file.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PCP_TRACE_HOST</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-19"></a><a class="indexterm" name="IG31371888142"></a>The <tt>
pmdatrace</tt> library routines use this variable when connecting
to the <tt>trace</tt> PMDA to determine on which host it is
running; see the <tt>pmdatrace(3)</tt> man page.
</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PCP_TRACE_PORT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-20"></a>This variable is used by both the <tt>trace</tt> PMDA and client programs using the <tt>pmdatrace</tt>
library to obtain the Internet port through which the client programs
and the PMDA communicate; see the <tt>pmdatrace(3)</tt>
man page.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PCP_TRACE_TIMEOUT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-21"></a>When <tt>pmdatrace</tt> client programs
are connecting to the <tt>trace</tt> PMDA, this variable can
be set to specify how long the clients should wait before cancelling their
attempt to connect with the PMDA; see the <tt>pmdatrace
(3)</tt> man page.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PMCD_CONNECT_TIMEOUT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-22"></a><a class="indexterm" name="IG31371888143"></a>When attempting to
connect to a remote PMCD on a system that is booting or at the other end
of a slow network link, some PMAPI routines could potentially block for
a long time until the remote system responds. These routines abort and
return an error if the connection has not been established after some
specified interval has elapsed. The default interval is 5 seconds. This
may be modified by setting this variable in the environment to a larger
number of seconds for the desired time out. This is most useful in cases
where the remote host is at the end of a slow network, requiring longer
latencies to establish the connection correctly.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PMCD_PORT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-23"></a><a class="indexterm" name="IG31371888144"></a><a class="indexterm" name="IG31371888145"></a>This TCP/IP port is used by PMCD to create
the socket for incoming connections and requests. The default is port
number 4321, which you may override by setting this variable to a different
port number. If a non-default port is in effect when PMCD is started,
then every monitoring application connecting to that PMCD must also have
this variable set in its environment before attempting a connection.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PMCD_RECONNECT_TIMEOUT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-24"></a><a class="indexterm" name="IG31371888146"></a>When a monitor
or client application loses its connection to a PMCD, the connection may
be reestablished by calling the <tt>pmReconnectContext()</tt>
PMAPI function. However, attempts to reconnect are controlled by a back-off
strategy to avoid flooding the network with reconnection requests. By
default, the back-off delays are 5, 10, 20, 40, and 80 seconds for consecutive
reconnection requests from a client (the last delay is repeated for any
further attempts after the last delay in the list). Setting this environment
variable to a comma-separated list of positive integers redefines the
back-off delays. For example, setting the delays to <b><tt>1,2</tt></b>
will back off for 1 second, then back off every 2 seconds thereafter.
</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PMCD_REQUEST_TIMEOUT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-25"></a><a class="indexterm" name="IG31371888147"></a>For monitor or client
applications connected to PMCD, there is a possibility of the application
hanging on a request for performance metrics or metadata or help text.
These delays may become severe if the system running PMCD crashes or the
network connection is lost or the network link is very slow. By setting
this environment variable to a real number of seconds, requests to PMCD
timeout after the specified number of seconds. The default behavior is
to wait 10 seconds for a response from every PMCD for all applications.
</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PMDA_PATH</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-28"></a>This environment variable may be used to modify
the search path used by PMCD and <tt>pmNewContext()</tt> (for <tt>PM_CONTEXT_LOCAL</tt> contexts) when searching for a daemon or DSO
PMDA. The syntax follows the syntax for shell <tt>PATH</tt>:
a colon-separated list of directories. The default search path is <tt>
/var/pcp/lib:/usr/pcp/lib</tt>.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PMLOGGER_PORT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="IG31371888148"></a><a class="indexterm" name="IG31371888149"></a><a class="indexterm" name="IG31371888150"></a>This
environment variable may be used to change the base TCP/IP port number
used by <tt>pmlogger</tt> to create the socket to which <tt>
pmlc</tt> instances try to connect. The default base port number
is 4330. If used, this variable should be set in the environment before <tt>
pmlogger</tt> is executed. If <tt>pmlc</tt> and <tt>
pmlogger</tt> are on different hosts, then obviously <tt>PMLOGGER_PORT</tt> must be set to the same value in both places.</p>

</td></tr><tr valign="top"><td colspan="2"><span class="term"><tt>PMNS_DEFAULT</tt></span></td></tr><tr valign="top"><td width="15%"> </td><td><p><a class="indexterm" name="ITch03-30"></a><a class="indexterm" name="IG31371888151"></a><a class="indexterm" name="IG31371888152"></a>If
set, this value is interpreted as the full pathname to be used as the
default PMNS for <tt>pmLoadNameSpace()</tt>. Otherwise, the
default PMNS is located at <tt>/var/pcp/pmns/root</tt> for
base PCP installations.</p>

</td></tr></table></div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="LE12082-PARENT"></a>3.5. Running PCP Tools through a Firewall</h2></div></div>
<p><a class="indexterm" name="IG31371888153"></a><a class="indexterm" name="IG31371888154"></a>In
some production environments, the Performance Co-Pilot (PCP) monitoring
hosts are on one side of a TCP/IP firewall, and the PCP collector hosts
may be on the other side.</p>
<p><a class="indexterm" name="IG31371888155"></a><a class="indexterm" name="IG31371888156"></a><a class="indexterm" name="IG31371888157"></a><a class="indexterm" name="IG31371888158"></a><a class="indexterm" name="IG31371888159"></a><a class="indexterm" name="IG31371888160"></a><a class="indexterm" name="IG31371888161"></a>If the firewall service is being provided
by a product that supports the <tt>sockd</tt> (SOCKS) protocols
for packet forwarding through the firewall, then the PCP tool <tt>pmsocks</tt> may be used; see the <tt>pmsocks
(1)</tt> man page. Otherwise, it is necessary to arrange for packet
forwarding to be enabled for those TCP/IP ports used by PCP, namely 4321
(or the value of the <tt>PMCD_PORT</tt> environment variable)
for connections to PMCD and a finite range of consecutive port numbers
starting at 4330 (or the value of the <tt>PMLOGGER_PORT</tt>
environment variable) to allow <tt>pmlc</tt> connections to <tt>
pmlogger</tt> instances.</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5196469"></a>3.5.1. The <tt>pmsocks</tt> Command</h3></div></div>
<p>The <tt>pmsocks</tt> command and its related files and
scripts allow PCP clients running on hosts located on the internal side
of a TCP/IP <tt>sockd</tt> firewall system to monitor remote
hosts on the other side of the firewall system. The basic syntax is as
follows, where <i>tool</i> is an arbitrary PCP application,
typically a monitoring tool:</p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">pmsocks <i>tool</i> <i>args</i></pre></td></tr></table><p><a class="indexterm" name="IG31371888162"></a>The <tt>pmsocks</tt> script prepares
the necessary environment variables and then executes the PCP tool specified
in <i>tool</i> across the firewall. For example, this
command runs <tt>dkvis</tt> with metrics fetched from <tt>remotehost</tt> on the other side of the firewall:</p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">pmsocks dkvis -h remotehost </pre></td></tr></table><p><a class="indexterm" name="IG31371888163"></a>The
configuration file is <tt>/etc/pcp_socks.conf</tt>, and the
network-specific information in this file is set to correspond with your
network. Complete information on this customization can be found in the <tt>pmsocks(1)</tt> man page.</p>
</div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="LE17322-PARENT"></a>3.6. Transient Problems with Performance Metric Values
</h2></div></div>
<p><a class="indexterm" name="IG31371888164"></a>Sometimes
the values for a performance metric as reported by a PCP tool appear to
be incorrect. This is typically caused by transient conditions such as
metric wraparound or time skew, described below. These conditions result
from design decisions that are biased in favor of lightweight protocols
and minimal resource demands for PCP components.</p>
<p>In all cases, these events are expected to occur infrequently, and
should not persist beyond a few samples.</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5196702"></a>3.6.1. Performance Metric Wraparound</h3></div></div>
<p><a class="indexterm" name="ITch03-32"></a><a class="indexterm" name="IG31371888165"></a>Performance metrics are usually expressed as numbers with
finite precision. For metrics that are cumulative counters of events or
resource consumption, the value of the metric may occasionally overflow
the specified range and wraparound to zero.</p>
<p>Because the value of these counter metrics is computed from the
rate of change with respect to the previous sample, this may result in
a transient condition where the rate of change is an unknown value. If
the <tt>PCP_COUNTER_WRAP</tt> environment variable is set, this
condition is treated as an overflow, and speculative rate calculations
are made. In either case, the correct rate calculation for the metric
returns with the next sample.</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5196749"></a>3.6.2. Time Dilation and Time Skew</h3></div></div>
<p><a class="indexterm" name="ITch03-33"></a>If
a PMDA is tardy in returning results, or the PCP monitoring tool is connected
to PMCD via a slow or congested network, an error might be introduced
in rate calculations due to a difference between the time the metric was
sampled and the time PMCD sends the result to the monitoring tool.</p>
<p>In practice, these errors are usually so small as to be insignificant,
and the errors are self-correcting (not cumulative) over consecutive samples.
</p>
<p>A related problem may occur when the system time is not synchronized
between multiple hosts, and the time stamps for the results returned from
PMCD reflect the skew in the system times. In this case, it is recommended
that NTP be used to keep the system clocks on the collector systems synchronized;
for information on <tt>ntp</tt>(1) see /<tt>usr/share/doc/ntp-4.1.1</tt>.</p>
</div></div></div><!--CONTENT_END--><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Table of Contents</a></td><td width="40%" align="right"> <a accesskey="n" href="ch04.html">Next</a></td></tr><tr><td width="40%" align="left">Chapter 2. Installing and Configuring Performance Co-Pilot
 </td><td width="20%" align="center"> </td><td width="40%" align="right">Chapter 4. Monitoring System Performance </td></tr></table></div></body></html>
