'\"macro stdmacro
.\"
.\" Copyright (c) 2000-2004 Silicon Graphics, Inc.  All Rights Reserved.
.\" 
.\" This program is free software; you can redistribute it and/or modify it
.\" under the terms of the GNU General Public License as published by the
.\" Free Software Foundation; either version 2 of the License, or (at your
.\" option) any later version.
.\" 
.\" This program is distributed in the hope that it will be useful, but
.\" WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
.\" or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
.\" for more details.
.\" 
.\" You should have received a copy of the GNU General Public License along
.\" with this program; if not, write to the Free Software Foundation, Inc.,
.\" 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
.\" 
.\" Contact information: Silicon Graphics, Inc., 1500 Crittenden Lane,
.\" Mountain View, CA 94043, USA, or: http://www.sgi.com
.\"
.ie \(.g \{\
.\" ... groff (hack for khelpcenter, man2html, etc.)
.TH PMSTORE 3 "SGI" "Performance Co-Pilot"
\}
.el \{\
.if \nX=0 .ds x} PMSTORE 3 "SGI" "Performance Co-Pilot"
.if \nX=1 .ds x} PMSTORE 3 "Performance Co-Pilot"
.if \nX=2 .ds x} PMSTORE 3 "" "\&"
.if \nX=3 .ds x} PMSTORE "" "" "\&"
.TH \*(x}
.rr X
\}
.SH NAME
\f3pmStore\f1,
\f3pmRequestStore\f1,
\f3pmReceiveStore\f1 \- modify values of performance metrics
.SH "C SYNOPSIS"
.ft 3
#include <pcp/pmapi.h>
.sp
.nf
int pmStore(const pmResult *result)
int pmRequestStore(int ctx, const pmResult *result)
int pmReceiveStore(int ctx)
.fi
.sp
cc ... \-lpcp
.ft 1
.SH DESCRIPTION
.de CW
.ie t \f(CW\\$1\f1\\$2
.el \fI\\$1\f1\\$2
..
In some special cases it may be helpful to modify the current values of
performance metrics,
e.g. to reset a counter to zero, or to modify a ``metric'' which is a control
variable for some agent collecting performance metrics.
.PP
The routine
.B pmStore
is a lightweight inverse of
.BR pmFetch (3).
.PP
The caller must build the
.CW pmResult 
data structure (of course, this could have been returned from an earlier
.BR pmFetch (3)
call) and then call
.BR pmStore .
.PP
It is an error to pass a request to
.B pmStore
in which the
.CW numval
field within any of the
.B pmValueSet
structure has a value less than one.
.PP
The current
Performance Metrics Application Programming Interface (PMAPI)
context must be one with a host as the source of metrics, and the
current value of the nominated metrics will be changed, i.e.
.B pmStore
cannot be used to make retrospective changes to information in either
the archive logs, or in the recent past for real-time sources of metrics.
.PP
The return code from
.B pmStore
is zero for success.
.PP
\f3pmRequestStore\fP and \f3pmReceiveStore\fP are used by
applications which must  communicate with the PMCD asynchronously.
These functions take explict context handle \f2ctx\fP which must refer
to a host context (i.e. created by passing \f3PM_CONTEXT_HOST\fP to
\f3pmNewContext\fP). \f3pmRequestStore\fP sends request to store data in
\f2result\f1 in the metrics and returns without waiting for the response,
\f3pmReceiveStore\fP reads confirmation from PMCD. It is the responsibility
of the application to make sure the data are ready before calling
\f3pmReceiveStore\f1 to avoid blocking.
.SH SEE ALSO
.BR PMAPI (3),
.BR pmFetch (3)
and
.BR pmSetMode (3).
.SH DIAGNOSTICS
.IP \f3PM_ERR_GENERIC\f1
At least one of the modifications was rejected.
No other status is available
from below the PMAPI (this is the lightweight part of the functionality!).  In
cases where the outcome of
.B pmStore
for individual metrics is important, the caller should make one call to
.B pmStore
for each metric. On the other hand, a bulk modification can be performed in a
single
.B pmStore
call for situations in which the outcome is not critical.
.IP \f3PM_ERR_NOTHOST\f1
The current PMAPI context is an archive rather than a host, or it
is a host that is not set to the current time, i.e. has been ``rewound''
to the recent past using
.BR pmSetMode (3).
.IP \f3PM_ERR_TOOSMALL\f1
The number of metrics specified in
.I result
is less than one.
.IP \f3PM_ERR_VALUE\f1
One or more of the
.CW pmValueSet s
in
.I result
has a
.CW numval
field with a value less than one.
.IP \f3PM_ERR_CTXBUSY\f1
Context is currently in use by another asynchronous call.
