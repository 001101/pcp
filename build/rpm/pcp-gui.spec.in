Summary: Visualisation tools for the Performance Co-Pilot toolkit
Name: @pkg_name@
Version: @pkg_version@
Release: @pkg_release@
Distribution: @pkg_distribution@
BuildRoot: @build_root@ 
Provides: kmchart
Obsoletes: kmchart
Conflicts: pcp-pro
Prereq: /sbin/ldconfig
Source: @pkg_name@-@pkg_version@.src.tar.gz
License: GPL
URL: http://oss.sgi.com/projects/pcp
Group: System Environment/Base
Requires: pcp >= 2.0
BuildRequires: pcp >= 2.0
%if "%{_vendor}" == "suse"
Requires: qt >= 4.2
BuildRequires: qt-devel >= 4.2
%else
Requires: qt4 >= 4.2
BuildRequires: qt4-devel >= 4.2
%endif

%description
The PCP GUI package primarily includes visualisation tools for
monitoring systems using live and archived Performance Co-Pilot
(PCP) sources.
These tools have dependencies on graphics libraries which may or
may not be installed on server machines, so PCP GUI is delivered,
managed and maintained as a separate (source and binary) package
to the core PCP infrastructure.

%prep
if [ -f .census ] ; then
   if [ ! -d ${RPM_PACKAGE_NAME}-${RPM_PACKAGE_VERSION} ] ; then
      ln -s . ${RPM_PACKAGE_NAME}-${RPM_PACKAGE_VERSION}
   fi
else
%setup
INSTALL_USER=root
INSTALL_GROUP=root
export INSTALL_USER INSTALL_GROUP
@make@ configure
fi

%build
@make@

%install
DIST_ROOT="$RPM_BUILD_ROOT"
DIST_INSTALL=`pwd`/install.manifest
export DIST_ROOT DIST_INSTALL
@make@ install DIST_MANIFEST="$DIST_INSTALL"
@make@ -C build/rpm rpmfiles DIST_MANIFEST="$DIST_INSTALL"

%clean
rm -rf $RPM_BUILD_ROOT

%files -f build/rpm/rpmfiles
